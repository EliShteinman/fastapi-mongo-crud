### **קובץ הדרכה: `שלב_1_הקמת_תשתית_הפרויקט.md`**

#### **1. מטרת השלב**

בשלב זה, אנו מקימים את היסודות לפרויקט "שירות CRUD עם FastAPI ו-MongoDB". המטרה היא ליצור סביבת עבודה נקייה, מבודדת ומסודרת, שתאפשר פיתוח יעיל וסקיילבילי. אנו נאתחל מאגר Git, נגדיר את מבנה התיקיות, ונתקין את התלויות הנדרשות.

---

#### **2. הסבר מעמיק על הפעולות שבוצעו**

בשלב זה ביצענו מספר פעולות תשתית קריטיות:

1.  **אתחול מאגר Git (`git init`):** הקמנו מערכת ניהול גרסאות שתעקוב אחר כל שינוי בקוד. זהו צעד בסיסי והכרחי בכל פרויקט תוכנה מקצועי, המאפשר עבודה מסודרת, שיתוף פעולה, וחזרה לגרסאות קודמות.

2.  **יצירת מבנה תיקיות:** הקמנו מבנה תיקיות המבוסס על עקרונות של הפרדת אחריויות (Separation of Concerns):
    *   **`app/`**: תיקייה זו תכיל את כל קוד המקור של האפליקציה (לוגיקה, API, מודלים וכו').
    *   **`infrastructure/`**: תיקייה זו מיועדת לקוד תשתית, בעיקר קבצי ה-YAML של OpenShift. זה מפריד בין הלוגיקה של האפליקציה לבין הגדרות הפריסה שלה.
    *   **`scripts/`**: תיקייה זו תשמש לכל סקריפט עזר, כמו סקריפטים לפריסה אוטומטית או לאתחול נתונים.

3.  **הגדרת סביבה וירטואלית (`venv`):** יצרנו סביבת פייתון מבודדת. פעולה זו מבטיחה שהספריות והתלויות של הפרויקט הנוכחי לא יתנגשו עם פרויקטים אחרים על אותו מחשב, ומאפשרת שחזור מדויק של סביבת הפיתוח בכל מקום.

4.  **הגדרת תלויות (`requirements.txt`):** בחרנו את הספריות המרכזיות לפרויקט:
    *   **`fastapi` ו-`uvicorn`**: מהווים את ליבת ה-API והשרת.
    *   **`motor`**: נבחר כדרייבר ל-MongoDB מכיוון שהוא אסינכרוני. FastAPI מבוסס על `asyncio` של פייתון, ושימוש בדרייבר אסינכרוני הוא קריטי כדי לא לחסום את ה-Event Loop ולנצל את מלוא יכולות הביצועים של FastAPI.
    *   **`beanie`**: נבחרה כספריית ODM (Object-Document Mapper). היא מפשטת את התקשורת עם MongoDB ומאפשרת לנו לעבוד עם אובייקטים של פייתון (המבוססים על Pydantic) במקום לכתוב שאילתות JSON באופן ידני. זה הופך את הקוד לקריא יותר, בטוח יותר (בזכות אימות סכמה), וקל יותר לתחזוקה.
    *   **`pydantic-settings`**: נבחרה לניהול הגדרות. יכולתה לקרוא הגדרות ממשתני סביבה באופן אוטומטי הופכת את האינטגרציה עם `Secrets` של OpenShift לפשוטה ומאובטחת, בהתאם לפרקטיקת "Twelve-Factor App".

---

#### **3. חלופות ושיקולים**

*   **ללא ODM (שימוש ב-`motor` ישירות):**
    *   **חלופה:** יכולנו לוותר על `beanie` ולכתוב את כל השאילתות ישירות עם `motor`.
    *   **יתרונות:** פחות תלות חיצונית, שליטה מלאה על השאילתות המדויקות שנשלחות ל-MongoDB.
    *   **חסרונות:** דורש כתיבת יותר קוד שחוזר על עצמו (boilerplate) עבור פעולות CRUD. קשה יותר לאכוף סכמה אחידה על הנתונים ב-Python, מה שפותח פתח לבאגים. `beanie` מספק שכבת בטיחות ונוחות משמעותית.

*   **חלופה ל-`motor` (שימוש ב-`pymongo`):**
    *   **חלופה:** `pymongo` הוא הדרייבר הסינכרוני הרשמי והנפוץ ביותר ל-MongoDB.
    *   **יתרונות:** ותיק יותר ומוכר לרבים.
    *   **חסרונות:** הוא סינכרוני (חוסם). שימוש בו בתוך endpoint אסינכרוני של FastAPI ידרוש "עטיפה" שלו ב-`ThreadPool` (למשל, `run_in_threadpool`), מה שמסבך את הקוד ומבטל את יתרון הביצועים של ארכיטקטורה אסינכרונית אמיתית. לכן, `motor` הוא הבחירה הנכונה באופן מובהק עבור FastAPI.

*   **חלופות לניהול תלויות (`Poetry`, `Pipenv`):**
    *   **חלופה:** שימוש בכלים מתקדמים יותר מ-`requirements.txt` ו-`venv`.
    *   **יתרונות:** כלים אלו מנהלים את הסביבה הוירטואלית ואת התלויות יחד. הם יוצרים קובץ `lock` שמבטיח שחזור סביבה זהה ב-100% בכל מחשב, כולל גרסאות מדויקות של תת-תלויות.
    *   **חסרונות:** דורשים התקנה ולמידה נוספת. לפרויקט ממוקד כמו זה, השילוב של `venv` ו-`requirements.txt` הוא סטנדרטי, פשוט ומספק לחלוטין.

